{"timestamp":"2025-08-19T13:45:17.769797","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-19T13:45:17.770232","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/fact_production.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-19T13:45:17.806557Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.806805Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.806947Z","level":"info","event":"Current task name:extract_and_transform_data","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.807028Z","level":"info","event":"Dag name:etl_fact_production_dag","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.807893Z","level":"info","event":"Starting data extraction and transformation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.809083","level":"warning","event":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py:471: DeprecationWarning: Using Connection.get_connection_from_secrets from `airflow.models` is deprecated.Please use `from airflow.sdk import Connection` instead\n  warnings.warn(\n","logger":"py.warnings"}
{"timestamp":"2025-08-19T13:45:17.814292","level":"info","event":"Connection Retrieved 'administration_recette'","logger":"airflow.hooks.base"}
{"timestamp":"2025-08-19T13:45:17.845747Z","level":"info","event":"Error in extract_and_transform_data: (psycopg2.errors.UndefinedTable) relation \"public.variables\" does not exist","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.846457Z","level":"info","event":"LINE 11:             FROM public.variables AS v","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.846601Z","level":"info","event":"                          ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.846667Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.846717Z","level":"info","event":"[SQL:","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.846769Z","level":"info","event":"            SELECT","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.846831Z","level":"info","event":"                v.name AS variable,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.846901Z","level":"info","event":"                e.id_variable AS id_variable,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.846965Z","level":"info","event":"                e.value AS valeur,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847033Z","level":"info","event":"                v.unit AS unit,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847095Z","level":"info","event":"                e.created_date AS date_entree,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847146Z","level":"info","event":"                e.id_site AS id_site,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847205Z","level":"info","event":"                v.type AS type,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847256Z","level":"info","event":"                v.equipment AS equipement","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847298Z","level":"info","event":"            FROM public.variables AS v","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847352Z","level":"info","event":"            LEFT JOIN public.entries AS e ON e.id_variable = v.id","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847425Z","level":"info","event":"            ORDER BY e.id_variable;","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847490Z","level":"info","event":"        ]","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.847537Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/f405)","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.845481","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"ProgrammingError","exc_value":"(psycopg2.errors.UndefinedTable) relation \"public.variables\" does not exist\nLINE 11:             FROM public.variables AS v\n                          ^\n\n[SQL: \n            SELECT\n                v.name AS variable,\n                e.id_variable AS id_variable,\n                e.value AS valeur,\n                v.unit AS unit,\n                e.created_date AS date_entree,\n                e.id_site AS id_site,\n                v.type AS type,\n                v.equipment AS equipement\n            FROM public.variables AS v\n            LEFT JOIN public.entries AS e ON e.id_variable = v.id\n            ORDER BY e.id_variable;\n        ]\n(Background on this error at: https://sqlalche.me/e/14/f405)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":890,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1177,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":217,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":240,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/fact_production.py","lineno":70,"name":"extract_and_transform_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/deprecated/classic.py","lineno":199,"name":"wrapper_function"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py","lineno":400,"name":"get_pandas_df"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/postgres/hooks/postgres.py","lineno":234,"name":"get_df"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":682,"name":"read_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1776,"name":"read_query"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1599,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1770,"name":"exec_driver_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1674,"name":"_exec_driver_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1953,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2134,"name":"_handle_dbapi_exception"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py","lineno":211,"name":"raise_"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]},{"exc_type":"UndefinedTable","exc_value":"relation \"public.variables\" does not exist\nLINE 11:             FROM public.variables AS v\n                          ^\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-08-19T13:45:17.848082Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848155Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848234Z","level":"info","event":"Task:<Task(PythonOperator): extract_and_transform_data>","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848296Z","level":"info","event":"Failure caused by (psycopg2.errors.UndefinedTable) relation \"public.variables\" does not exist","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848370Z","level":"info","event":"LINE 11:             FROM public.variables AS v","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848430Z","level":"info","event":"                          ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848513Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848573Z","level":"info","event":"[SQL:","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848621Z","level":"info","event":"            SELECT","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848661Z","level":"info","event":"                v.name AS variable,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848721Z","level":"info","event":"                e.id_variable AS id_variable,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848797Z","level":"info","event":"                e.value AS valeur,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848883Z","level":"info","event":"                v.unit AS unit,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848931Z","level":"info","event":"                e.created_date AS date_entree,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.848987Z","level":"info","event":"                e.id_site AS id_site,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.849070Z","level":"info","event":"                v.type AS type,","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.849125Z","level":"info","event":"                v.equipment AS equipement","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.849192Z","level":"info","event":"            FROM public.variables AS v","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.849257Z","level":"info","event":"            LEFT JOIN public.entries AS e ON e.id_variable = v.id","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.849329Z","level":"info","event":"            ORDER BY e.id_variable;","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.849393Z","level":"info","event":"        ]","chan":"stdout","logger":"task"}
{"timestamp":"2025-08-19T13:45:17.849456Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/f405)","chan":"stdout","logger":"task"}
